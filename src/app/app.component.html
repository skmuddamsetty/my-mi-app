<ion-app>
  <ion-split-pane>
    <ion-menu>
      <ion-header>
        <ion-toolbar>
          <ion-title text-center>Menu</ion-title>
        </ion-toolbar>
      </ion-header>
      <ion-content>
        <ion-list>
          <ion-menu-toggle
            auto-hide="false"
            *ngFor="let p of appPages; let i = index"
          >
            <div
              *ngIf="p.subPages && p.subPages.length > 0"
              class="sub-pages-main-box"
            >
              <ion-item
                *ngIf="
                  p.dynamicRoute &&
                  p.isAvailable &&
                  ((p.title !== 'Login' && p.title !== 'Logout') ||
                    (p.title === 'Login' && !this.isAuthenticated) ||
                    (p.title === 'Logout' && this.isAuthenticated))
                "
                (click)="toggleGroup(i)"
              >
                <ion-icon
                  slot="start"
                  [name]="p.icon"
                  color="medium"
                ></ion-icon>
                <ion-label>
                  {{ p.title }}
                </ion-label>
                <ion-icon
                  slot="end"
                  name="arrow-dropdown"
                  color="medium"
                  *ngIf="!isGroupShown(i)"
                ></ion-icon>
                <ion-icon
                  slot="end"
                  name="arrow-dropup"
                  color="medium"
                  *ngIf="isGroupShown(i)"
                ></ion-icon>
              </ion-item>
              <div *ngIf="isGroupShown(i)">
                <div class="sub-pages" *ngFor="let item of p.subPages">
                  <ion-item
                    *ngIf="item.isAvailable"
                    [routerDirection]="'root'"
                    [routerLink]="[item.url, item.category]"
                    (click)="setCurrentCategory(item.category, item.title)"
                  >
                    <ion-icon
                      slot="start"
                      [name]="item.icon"
                      color="medium"
                    ></ion-icon>
                    <ion-label>
                      {{ item.title }}
                    </ion-label>
                    <ion-badge
                      color="light"
                      slot="end"
                      *ngIf="
                        item.numberofQuestions && item.numberofQuestions > 0
                      "
                      >{{ item.numberofQuestions }}</ion-badge
                    >
                  </ion-item>
                </div>
              </div>
            </div>
            <div *ngIf="p.subPages && p.subPages.length <= 0">
              <ion-item
                *ngIf="
                  p.dynamicRoute &&
                  p.isAvailable &&
                  ((p.title !== 'Login' && p.title !== 'Logout') ||
                    (p.title === 'Login' && !this.isAuthenticated) ||
                    (p.title === 'Logout' && this.isAuthenticated))
                "
                [routerDirection]="'root'"
                [routerLink]="[p.url, p.category]"
                (click)="setCurrentCategory(p.category, p.title)"
              >
                <ion-icon
                  slot="start"
                  [name]="p.icon"
                  color="medium"
                ></ion-icon>
                <ion-label>
                  {{ p.title }}
                </ion-label>
                <ion-badge
                  color="light"
                  slot="end"
                  *ngIf="p.numberofQuestions && p.numberofQuestions > 0"
                  >{{ p.numberofQuestions }}</ion-badge
                >
              </ion-item>
              <ion-item
                *ngIf="
                  !p.dynamicRoute &&
                  p.isAvailable &&
                  ((p.title !== 'Login' && p.title !== 'Logout') ||
                    (p.title === 'Login' && !this.isAuthenticated) ||
                    (p.title === 'Logout' && this.isAuthenticated))
                "
                [routerDirection]="'root'"
                [routerLink]="[p.url]"
                (click)="setCurrentCategory(p.category, p.title)"
              >
                <ion-icon
                  slot="start"
                  [name]="p.icon"
                  color="medium"
                ></ion-icon>
                <ion-label>
                  {{ p.title }}
                </ion-label>
                <ion-badge
                  color="light"
                  slot="end"
                  *ngIf="p.numberofQuestions && p.numberofQuestions > 0"
                  >{{ p.numberofQuestions }}</ion-badge
                >
              </ion-item>
            </div>
          </ion-menu-toggle>
        </ion-list>
      </ion-content>
    </ion-menu>
    <ion-router-outlet main></ion-router-outlet>
  </ion-split-pane>
</ion-app>
